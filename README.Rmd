---
output: github_document
format: gfm
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  out.width = "100%",
  fig.path = "man/figures/README-",
  fig.retina = 3,
  echo = TRUE
)
``` 
 
# ggnut 
 
This fork of the {ggseg} project uses `ggregions` to create layers (annotation layers 'stamp', and mapped geom_*s). It uses [ggseg](https://ggseg.github.io/ggseg/) data - a well thought out and maintained project: see the [Advances in Methods and Practices in Psychological Science](https://journals.sagepub.com/doi/10.1177/2515245920928009) paper.  

The ggnut user is expected to have little clue about the brain, (might confuse a [walnut](https://en.wikipedia.org/wiki/Walnut) for a brain).  With ggnut, brain region newcomers might able to orient themselves to some brain regions, that they might have heard discussed in the media, for example, couldn't say where they reside in the brain, looking just at the aseg brain atlas, and coronal view (the ggseg project encompass many more atlas and their regions). 

Thinking about mapping brain regions was a very motivating case for ggregions, however it's not too clear that it makes a good usecase (still hopeful that it can be useful in geo context ðŸ¤žðŸ¤ž https://github.com/EvaMaeRey/ggusmap or maybe less amorphous regions - looking for a teeth atlas!)



# Getting started...

Meeting the assumptions/naivite of the ggregions package.  I've only used ggregions with simple 1-1 relationships, region name <-> region 


```{r, message = F, warning=F}
library(ggregions)
library(ggplot2)
library(dplyr)

ggseg::aseg$data
```

For better or worse, the 1-to-1 isn't true of the atlas, so we use `sf::st_combine()` and we just focus on one side. 

```{r}
coronal_ref_data <- ggseg::aseg$data |> 
  filter(side == "coronal") |>     # just look at coronal for the nuttiness.
  group_by(region) |> 
  summarise(geometry = sf::st_combine(geometry)) |> 
  select(region, everything())
  
coronal_ref_data |> pull(region)
```

Also, "nut" can refer to the head/brain in English in informal speech. 


```{r}
geom_seg <- write_geom_region_locale(ref_data = coronal_ref_data)
stamp_seg <- write_stamp_region_locale(ref_data = coronal_ref_data)
geom_seg_text <- write_geom_region_text_locale(ref_data = coronal_ref_data)
stamp_seg_text <- write_stamp_region_text_locale(ref_data = coronal_ref_data)

library(ggseg) # library ggnut - a ggseg derivitive...

ggplot() + 
  stamp_seg() + 
  stamp_seg(keep = "hippocampus", fill = "blue")

last_plot() + 
  stamp_seg(keep = "amygdala", fill = "magenta")

last_plot() + 
  stamp_seg(keep = "pallidum", fill = "orange")
```



Hmmm... below not working... Arg! puzzles.

```{r}
coronal_ref_data |> head()

tribble(~region_name, ~activity,
        "hippocampus", 1,
        "amygdala", .2) |> 
  ggplot() + 
  aes(region = region_name,
      alpha = activity) +
  stamp_seg() + 
  geom_seg()


layer_data(i = 2)
```





![](https://images.unsplash.com/photo-1626012109496-21f579f648dd?q=80&w=1160&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D)

